<!DOCTYPE html>

<style type="text/css">
  /* General Page Styling */
  html {
    background-image: url('rainforestBackground.jpg');
    background-color: lightgreen;
    background-size: auto;
    background-repeat: no-repeat;
    font-family: 'Verdana';
    font-size: 10px;
    text-align: center;
  }

  /* Heading */
  .heading {
    font-size: 50px;
    font-weight: 900;
    color: white;
    padding: 20px;
    background-color: grey;
  }

  /* Clock Components */
  .clock {
    position: relative;
    top, bottom, left, right: 0;
    margin: auto;
    width: 715px;
    height: 715px;
    border-radius: 50%;
    background-image: url('clockFace.png');
  }
  .clock-face {
    position: relative;
    width: 100%;
    height: 100%;
  }
  .hand {
    position: absolute;
    top: 50%;
    width: 50%;
    transform-origin: 100%;
    height: 10px;
    transform: rotate(90deg);
    transition: all 0.5s;
   }
  .hour-hand {
    background: black;
    left: 30%;
    width: 20%;
    /* background-image: url('hour.png'); */
  }
  .minute-hand { 
    background: black;
    left: 10%;
    width: 40%;
    /* background-image: url('minute.png'); */
  }
  .second-hand { 
    background: red; 
    left: 5%;
    width: 45%;
    height: 6px;
  }
  .digitalClock {
    font-size: 30px;
    padding-left: 100px;
    padding-right: 100px;
    position: relative;
    text-align: center;
    top: 60%;
    margin: auto;
    width: 200px;
    border: 5px solid black;
    border-radius: 10%;
    padding: 10px;
    background: lightgreen;
  }
  
  /* Description Box Area */
  .description-box {
    top, bottom, left, right: 0;
    margin: auto;
    display: flex;
    flex: 1;
    font-size: 20px;
    padding: 10px;
    background-color: white;
    width: 70%;
    border: 15px solid black;
    border-radius: 25%;
    transform: translateY(100px);
  }
  
  /* Cuckoo Bird Images */
  img.cuckooBird-small {
    height: 20%;
    width: 20%;
  }
  

  img.cuckooBird-big {
    position: absolute;
    height: 500px;
    width: 500px;
    margin-bottom:-200px;
    margin-right: -100px;
    z-index: -1;
    visibility: hidden;
    transform: rotate(40deg);
  }

</style>

<head>
  <meta charset="UTF-8">
  <title> my CooCoo-Clock </title>
</head>

<body>

  <h1 class="heading"> Javascript Cuckoo Clock </h1>
  
  <img class="cuckooBird-big" src="cuckooBird.gif">
  <audio src="sounds/cuckooNoise.mp3"></audio>

  <!-- Analogue Clock -->
  <div class="clock">
    <div class="clock-face">
      <div class="hand hour-hand"> </div>
      <div class="hand minute-hand"> </div>
      <div class="hand second-hand"> </div>
      <!-- AM or PM -->
      <div class="digitalClock"> </div>
    </div>
  </div> 

  <!-- Description Box -->
  <div class="description-box">
    <p> <strong> About this Javascript Cuckoo Clock: </strong> </br > At the start of every hour, a larger version of this bird pops out from behind the clock and makes a cuckoo noise. Note that the actual bird used here is not a cuckoo bird... but the actual noise is of an actual cuckoo bird. Each time a clock hand reaches the top it stylishly spins back around to the start. </p>
    <img class="cuckooBird-small" src="cuckooBird.gif"> 
  </div>

</body>

<script>
  
  const hourHand = document.querySelector('.hour-hand');
  const minuteHand = document.querySelector('.minute-hand');
  const secondHand = document.querySelector('.second-hand');
  const digitalClock = document.querySelector('.digitalClock');

  const cuckooBird = document.querySelector('.cuckooBird-big');
  const cuckooNoise = document.querySelector('audio');

  function setTime() {
    // Get the current time in hours, minutes, seconds
    const currentTime = new Date();
    const hours = currentTime.getHours();
    const minutes = currentTime.getMinutes();
    const seconds = currentTime.getSeconds();
    const AM_PM = (0 <= hours && hours < 12) ? "AM" : "PM";
    console.log(currentTime);

    // perform cuckoo at the start of every new hour
    if (seconds === 0 && hours === 0) {
      // make the cuckoo bird appear and play the cuckoo noise
      cuckooBird.style.visibility = `visible`;
      cuckooNoise.play();
      console.log(cuckooNoise);
    };

    // if the cuckoo noise isn't playing, the cuckoo bird is hiding.
    if (cuckooNoise.ended) {
      cuckooBird.style.visibility = `hidden`;
    };
    
    // Calculate the angle for each of the hands
    const hoursDegrees = ((hours / 12) * 360) + 90;
    const minutesDegrees = ((minutes / 60) * 360) + 90;
    const secondsDegrees = ((seconds / 60) * 360) + 90;

    // Apply the calculated angle to set the time
    hourHand.style.transform = `rotate(${hoursDegrees}deg)`;
    minuteHand.style.transform = `rotate(${minutesDegrees}deg)`;
    secondHand.style.transform = `rotate(${secondsDegrees}deg)`;

    // Also set digital clock
    const stringHours = hours%12;
    const stringMinutes = (minutes < 10) ? "0"+minutes : minutes;
    const stringSeconds = (seconds < 10) ? "0"+seconds : seconds;
    digitalClock.innerHTML = `${stringHours}:${stringMinutes}:${stringSeconds} ${AM_PM}`;
    
  };

    setInterval(setTime, 1000); // performs the setTime function every 1000ms = 1s

</script>

</html>